---

- name: 'Stopping {{ pgrole }}'
  docker_container:
    name: '{{ pgrole }}'
    state: stopped

- name: 'Creating metube folder paths'
  become: yes
  file:
    path: "{{item}}"
    state: "directory"
    mode: "0777"
    owner: "{{user.userid}}"
    group: "{{user.groupid}}"
    recurse: "yes"
  with_items:
    - "{{ lookup('env','CONFDIR') }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/config"
    - "{{ lookup('env','CONFDIR') }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/downloads/videos"
    - "{{ lookup('env','CONFDIR') }}/docker/{{ lookup('env','USER') }}/{{ pgrole }}/downloads/audios"

- name: Restart {{ pgrole }}
  docker_container:
    name: '{{ pgrole }}'
    state: started
